# Iterating on the dropkick Nix flake

The Nix flake used for dropkick is at [src/nix/flake.nix](../src/nix/flake.nix). It can be helpful to run `nix build` directly for iterative development, but the flake reads an `input.json` file generated by dropkick. You can generate this with `dropkick dump-nix-input`, which takes roughly the same arguments as `dropkick build`; for example:

```bash
dropkick dump-nix-input --hostname beachball.example ~/git/beachball >src/nix/input.json
```

## Adding files to nix/mod.rs

Files in [src/nix](../src/nix) are not automatically added to the Nix environment generated in a temporary directory by dropkick. If you create new files, add them to `NIX_ENV` in src/nix/mod.rs, or if they need to be dynamically generated, in the `NixosBuilder::build` method.
